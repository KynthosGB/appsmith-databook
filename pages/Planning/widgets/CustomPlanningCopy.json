{
  "backgroundColor": "#FFFFFF",
  "borderColor": "#E0DEDE",
  "borderRadius": "{{appsmith.theme.borderRadius.appBorderRadius}}",
  "borderWidth": "1",
  "bottomRow": 137,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "defaultModel": "{{ { rows: QryDashboardSuiviFabrication.data || [] } }}",
  "dynamicBindingPathList": [
    {
      "key": "theme"
    },
    {
      "key": "borderRadius"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "defaultModel"
    }
  ],
  "dynamicHeight": "AUTO_HEIGHT",
  "dynamicPropertyPathList": [],
  "dynamicTriggerPathList": [],
  "events": [],
  "isCanvas": false,
  "isLoading": false,
  "isSearchWildcard": true,
  "isVisible": true,
  "key": "ctx98s9hxm",
  "leftColumn": 1,
  "maxDynamicHeight": 9000,
  "minDynamicHeight": 4,
  "mobileBottomRow": 40,
  "mobileLeftColumn": 19,
  "mobileRightColumn": 42,
  "mobileTopRow": 10,
  "needsErrorInfo": false,
  "originalBottomRow": 137,
  "originalTopRow": 33,
  "parentColumnSpace": 20.25,
  "parentId": "0",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "rightColumn": 63,
  "shouldScrollContents": true,
  "srcDoc": {
    "css": "@charset \"UTF-8\";\n/* Toolbar zoom */\n.planning-toolbar {\n  display: flex;\n  gap: 8px;\n  margin-bottom: 6px;\n}\n\n.planning-toolbar button {\n  font-size: 11px;\n  padding: 4px 8px;\n  border-radius: 4px;\n  border: 1px solid #d1d5db;\n  background: #f9fafb;\n  cursor: pointer;\n}\n\n.planning-toolbar button:hover {\n  background: #e5e7eb;\n}\n\n/* Le Gantt occupe tout l'espace du widget */\n#gantt_here {\n  width: 100%;\n  min-height: 1000px; /* hauteur minimum visible */\n}\n\n/* Couleurs des t√¢ches suivant le statut */\n.gantt_task_line.status-A_FAIRE {\n  background-color: #ef4444;\n  border-color: #b91c1c;\n}\n\n.gantt_task_line.status-EN_COURS,\n.gantt_task_line.status-ATTENTE_CLIENT {\n  background-color: #eab308;\n  border-color: #a16207;\n}\n\n.gantt_task_line.status-TERMINE,\n.gantt_task_line.status-VALIDE_CLIENT {\n  background-color: #22c55e;\n  border-color: #15803d;\n}\n\n/* Week-end l√©g√®rement gris√© */\n.gantt_scale_cell.weekend,\n.gantt_task_cell.weekend {\n  background-color: #f3f4f6;\n}\n\n/* R√©duction taille du texte dans la grille (tableau √† gauche) */\n.gantt_grid, .gantt_grid * {\n  font-size: 10px !important;\n}\n\n/* R√©duction taille du texte dans la timeline */\n.gantt_task, .gantt_task * {\n  font-size: 10px !important;\n}\n\n/* R√©duction taille du header grille */\n.gantt_grid_head_cell {\n  font-size: 11px !important;\n}\n\n/* R√©duction taille du header timeline */\n.gantt_scale_cell {\n  font-size: 11px !important;\n}",
    "html": "<link\n  rel=\"stylesheet\"\n  href=\"https://cdn.dhtmlx.com/gantt/edge/dhtmlxgantt.css\"\n/>\n\n<div class=\"planning-toolbar\">\n  <button data-zoom=\"day\">Jour</button>\n  <button data-zoom=\"week\">Semaine</button>\n  <button data-zoom=\"month\">Mois</button>\n</div>\n\n<div id=\"gantt_here\"></div>\n",
    "js": "// -------- Helpers g√©n√©raux --------\n\n// Calcule automatiquement la largeur id√©ale de la colonne Task name\nfunction computeTaskColumnWidth(tasks) {\n  // nombre minimal de caract√®res\n  let maxChars = 10;\n  (tasks || []).forEach(t => {\n    const label = t.type === \"project\" ? t.nom_appareil || t.text || \"\" : t.text || \"\";\n    if (label.length > maxChars) {\n      maxChars = label.length;\n    }\n  });\n\n  // approx : 7 px par caract√®re + padding\n  return Math.min(maxChars * 7 + 40, 600); // limite max 600px\n}\n\n// Charge dhtmlxGantt une seule fois\nfunction ensureGanttLoaded() {\n  if (window.gantt) return Promise.resolve();\n  if (window.ganttLoading) return window.ganttLoading;\n  window.ganttLoading = new Promise((resolve, reject) => {\n    const script = document.createElement(\"script\");\n    script.src = \"https://cdn.dhtmlx.com/gantt/edge/dhtmlxgantt.js\";\n    script.onload = () => resolve();\n    script.onerror = reject;\n    document.head.appendChild(script);\n  });\n  return window.ganttLoading;\n}\n\n// Format YYYY-MM-DD -> DD-MM-YYYY\nfunction formatDateFr(isoStr) {\n  if (!isoStr) return \"\";\n  const s = String(isoStr).slice(0, 10); // garde que AAAA-MM-JJ\n  const parts = s.split(\"-\");\n  if (parts.length !== 3) return s;\n  const [y, m, d] = parts;\n  return `${d}-${m}-${y}`;\n}\n\n// Gestion du zoom (√©chelles jour / semaine / mois)\nfunction setScale(level) {\n  if (!window.gantt) return;\n  switch (level) {\n    case \"day\":\n      gantt.config.scales = [{\n        unit: \"month\",\n        step: 1,\n        format: \"%F %Y\"\n      }, {\n        unit: \"day\",\n        step: 1,\n        format: \"%d-%m\"\n      }];\n      break;\n    case \"month\":\n      gantt.config.scales = [{\n        unit: \"year\",\n        step: 1,\n        format: \"%Y\"\n      }, {\n        unit: \"month\",\n        step: 1,\n        format: \"%M\"\n      }];\n      break;\n    case \"week\":\n    default:\n      gantt.config.scales = [{\n        unit: \"year\",\n        step: 1,\n        format: \"%Y\"\n      }, {\n        unit: \"week\",\n        step: 1,\n        format: function (date) {\n          const weekStr = gantt.date.date_to_str(\"%W\")(date);\n          return \"S\" + weekStr;\n        }\n      }, {\n        unit: \"day\",\n        step: 1,\n        format: \"%d\"\n      }];\n      break;\n  }\n  gantt.render();\n}\n\n// -------- Mapping des donn√©es Appsmith -> Gantt --------\n\n// Transforme QryDashboardSuiviFabrication.data -> { data: tasks, links }\nfunction mapRowsToGantt(rows) {\n  const tasks = [];\n  const links = [];\n  rows.forEach(r => {\n    const appareilId = String(r.numero_appareil);\n    const appareilLabel = `${r.numero_appareil} - ${r.nom_appareil}`;\n    const etapes = Array.isArray(r.etapes) ? r.etapes : [];\n\n    // d√©lai de l'appareil (pour la barre projet et pour la colonne Start time)\n    const delaiStr = r.delai ? String(r.delai).slice(0, 10) : null;\n\n    // --- date de la premi√®re √©tape (min des dates) ---\n    let firstStepDate = null;\n    etapes.forEach((e, idx) => {\n      const rawStart = e.date_objectif || e.date_fin;\n      const rawEnd = e.date_fin || e.date_objectif;\n      if (!rawStart && !rawEnd) return;\n      const startStr = String(rawStart || rawEnd).slice(0, 10); // YYYY-MM-DD\n\n      if (!firstStepDate || startStr < firstStepDate) {\n        firstStepDate = startStr;\n      }\n    });\n    const today = new Date().toISOString().slice(0, 10);\n\n    // --- dates de la barre \"projet\" (bleue) ---\n    // d√©but = premi√®re √©tape, sinon d√©lai, sinon aujourd'hui\n    const projectStart = firstStepDate || delaiStr || today;\n    // fin = d√©lai, sinon premi√®re √©tape, sinon d√©but\n    const projectEnd = delaiStr || firstStepDate || projectStart;\n\n    // --- t√¢che \"projet\" pour l'appareil ---\n    tasks.push({\n      id: appareilId,\n      text: appareilLabel,\n      nom_appareil: r.nom_appareil,\n      // utilis√© dans la colonne Task name\n      start_date: projectStart,\n      // üëà d√©but = premi√®re √©tape\n      end_date: projectEnd,\n      // üëà fin = d√©lai\n      delai: delaiStr,\n      // pour la colonne Start time de la grille\n      type: \"project\",\n      open: true\n    });\n\n    // --- t√¢ches enfants pour chaque grande √©tape ---\n    let prevChildId = null;\n    etapes.forEach((e, idx) => {\n      const code = e.groupe_code || `ETAPE_${idx}`;\n      const libelle = e.groupe_libelle || code;\n      const rawStart = e.date_objectif || e.date_fin;\n      const rawEnd = e.date_fin || e.date_objectif;\n      if (!rawStart && !rawEnd) return;\n      const startStr = String(rawStart || rawEnd).slice(0, 10);\n      let endStr = String(rawEnd || rawStart).slice(0, 10);\n\n      // Gantt n'aime pas les t√¢ches de dur√©e 0 -> on force +1 jour si start=end\n      if (endStr === startStr) {\n        const d = new Date(startStr + \"T00:00:00Z\");\n        d.setUTCDate(d.getUTCDate() + 1);\n        endStr = d.toISOString().slice(0, 10);\n      }\n      const childId = `${appareilId}_${code}_${idx}`;\n      tasks.push({\n        id: childId,\n        text: libelle,\n        start_date: startStr,\n        end_date: endStr,\n        parent: appareilId,\n        progress: 0,\n        status: e.statut_code,\n        // pour la couleur via CSS\n        date_objectif: e.date_objectif ? String(e.date_objectif).slice(0, 10) : null // utilis√© dans ta colonne Start time pour les √©tapes\n      });\n\n      // lien de d√©pendance (fin -> d√©but) avec l'√©tape pr√©c√©dente de l'appareil\n      if (prevChildId) {\n        links.push({\n          id: `${prevChildId}->${childId}`,\n          source: prevChildId,\n          target: childId,\n          type: 0 // 0 = finish_to_start\n        });\n      }\n      prevChildId = childId;\n    });\n  });\n  return {\n    data: tasks,\n    links\n  };\n}\n\n// -------- Initialisation + rendu Gantt --------\n\nasync function renderGantt() {\n  const rows = appsmith.model && appsmith.model.rows || [];\n  if (!Array.isArray(rows) || !rows.length) return;\n  await ensureGanttLoaded();\n\n  // üîπ on mappe D'ABORD les donn√©es -> tasks + links\n  const ganttData = mapRowsToGantt(rows);\n\n  // üîπ on calcule la largeur id√©ale de la colonne \"Task name\"\n  const idealWidth = computeTaskColumnWidth(ganttData.data);\n\n  // Init une seule fois\n  if (!window.ganttInitialized) {\n    // lecture seule\n    gantt.config.readonly = true;\n    gantt.config.date_format = \"%Y-%m-%d\";\n\n    // (dans la version gratuite, grid_resize ne donne pas de drag, mais on peut le laisser)\n    gantt.config.grid_resize = true;\n\n    // Colonnes du tableau √† gauche\n    gantt.config.columns = [{\n      name: \"text\",\n      label: \"Task name\",\n      tree: true,\n      width: idealWidth,\n      // üëà largeur auto en fonction du texte\n      min_width: 120,\n      template: function (task) {\n        // Pour les appareils : uniquement le nom_appareil\n        if (task.type === \"project\") {\n          return task.nom_appareil || task.text;\n        }\n        // Pour les √©tapes : libell√© normal\n        return task.text;\n      }\n    }, {\n      // Colonne start personnalis√©e :\n      // appareil  -> d√©lai de l'appareil\n      // √©tape     -> date objectif\n      name: \"start_custom\",\n      label: \"Start time\",\n      align: \"center\",\n      width: 100,\n      template: function (task) {\n        if (task.type === \"project\") {\n          const d = task.delai || task.start_date;\n          return formatDateFr(d);\n        }\n        const d = task.date_objectif || task.start_date;\n        return formatDateFr(d);\n      }\n    }, {\n      // Colonne fin en DD-MM-YYYY\n      name: \"end_custom\",\n      label: \"End time\",\n      align: \"center\",\n      width: 100,\n      template: function (task) {\n        return formatDateFr(task.end_date);\n      }\n    }];\n\n    // Week-end en gris\n    gantt.templates.scale_cell_class = function (date) {\n      const day = date.getDay();\n      return day === 0 || day === 6 ? \"weekend\" : \"\";\n    };\n    gantt.templates.timeline_cell_class = function (task, date) {\n      const day = date.getDay();\n      return day === 0 || day === 6 ? \"weekend\" : \"\";\n    };\n\n    // Classe CSS selon le statut\n    gantt.templates.task_class = function (start, end, task) {\n      if (task.status) {\n        return \"status-\" + task.status;\n      }\n      return \"\";\n    };\n\n    // Init gantt\n    gantt.init(\"gantt_here\");\n    window.ganttInitialized = true;\n\n    // Zoom par d√©faut : vue semaine\n    setScale(\"week\");\n\n    // Gestion des boutons de zoom dans la toolbar HTML\n    const toolbar = document.querySelector(\".planning-toolbar\");\n    if (toolbar) {\n      toolbar.addEventListener(\"click\", function (e) {\n        const btn = e.target.closest(\"button[data-zoom]\");\n        if (!btn) return;\n        const level = btn.getAttribute(\"data-zoom\");\n        setScale(level);\n      });\n    }\n  }\n\n  // üîπ on applique ensuite les donn√©es\n  gantt.clearAll();\n  gantt.parse(ganttData);\n}\n\n// Initialisation et rafra√Æchissements\nappsmith.onReady(renderGantt);\nappsmith.onModelChange(renderGantt);\n\n// Initialisation et rafra√Æchissements\nappsmith.onReady(renderGantt);\nappsmith.onModelChange(renderGantt);"
  },
  "theme": "{{appsmith.theme}}",
  "topRow": 33,
  "type": "CUSTOM_WIDGET",
  "uncompiledSrcDoc": {
    "css": "/* Toolbar zoom */\n.planning-toolbar {\n  display: flex;\n  gap: 8px;\n  margin-bottom: 6px;\n}\n\n.planning-toolbar button {\n  font-size: 11px;\n  padding: 4px 8px;\n  border-radius: 4px;\n  border: 1px solid #d1d5db;\n  background: #f9fafb;\n  cursor: pointer;\n}\n\n.planning-toolbar button:hover {\n  background: #e5e7eb;\n}\n\n/* Le Gantt occupe tout l'espace du widget */\n#gantt_here {\n  width: 100%;\n  min-height: 1000px; /* hauteur minimum visible */\n}\n\n/* Couleurs des t√¢ches suivant le statut */\n.gantt_task_line.status-A_FAIRE {\n  background-color: #ef4444;\n  border-color: #b91c1c;\n}\n\n.gantt_task_line.status-EN_COURS,\n.gantt_task_line.status-ATTENTE_CLIENT {\n  background-color: #eab308;\n  border-color: #a16207;\n}\n\n.gantt_task_line.status-TERMINE,\n.gantt_task_line.status-VALIDE_CLIENT {\n  background-color: #22c55e;\n  border-color: #15803d;\n}\n\n/* Week-end l√©g√®rement gris√© */\n.gantt_scale_cell.weekend,\n.gantt_task_cell.weekend {\n  background-color: #f3f4f6;\n}\n\n/* R√©duction taille du texte dans la grille (tableau √† gauche) */\n.gantt_grid, .gantt_grid * {\n  font-size: 10px !important;\n}\n\n/* R√©duction taille du texte dans la timeline */\n.gantt_task, .gantt_task * {\n  font-size: 10px !important;\n}\n\n/* R√©duction taille du header grille */\n.gantt_grid_head_cell {\n  font-size: 11px !important;\n}\n\n/* R√©duction taille du header timeline */\n.gantt_scale_cell {\n  font-size: 11px !important;\n}\n\n",
    "html": "<link\n  rel=\"stylesheet\"\n  href=\"https://cdn.dhtmlx.com/gantt/edge/dhtmlxgantt.css\"\n/>\n\n<div class=\"planning-toolbar\">\n  <button data-zoom=\"day\">Jour</button>\n  <button data-zoom=\"week\">Semaine</button>\n  <button data-zoom=\"month\">Mois</button>\n</div>\n\n<div id=\"gantt_here\"></div>\n",
    "js": "// -------- Helpers g√©n√©raux --------\n\n// Calcule automatiquement la largeur id√©ale de la colonne Task name\nfunction computeTaskColumnWidth(tasks) {\n  // nombre minimal de caract√®res\n  let maxChars = 10;\n\n  (tasks || []).forEach(t => {\n    const label =\n      t.type === \"project\"\n        ? (t.nom_appareil || t.text || \"\")\n        : (t.text || \"\");\n\n    if (label.length > maxChars) {\n      maxChars = label.length;\n    }\n  });\n\n  // approx : 7 px par caract√®re + padding\n  return Math.min(maxChars * 7 + 40, 600); // limite max 600px\n}\n\n\n// Charge dhtmlxGantt une seule fois\nfunction ensureGanttLoaded() {\n  if (window.gantt) return Promise.resolve();\n\n  if (window.ganttLoading) return window.ganttLoading;\n\n  window.ganttLoading = new Promise((resolve, reject) => {\n    const script = document.createElement(\"script\");\n    script.src = \"https://cdn.dhtmlx.com/gantt/edge/dhtmlxgantt.js\";\n    script.onload = () => resolve();\n    script.onerror = reject;\n    document.head.appendChild(script);\n  });\n\n  return window.ganttLoading;\n}\n\n// Format YYYY-MM-DD -> DD-MM-YYYY\nfunction formatDateFr(isoStr) {\n  if (!isoStr) return \"\";\n  const s = String(isoStr).slice(0, 10); // garde que AAAA-MM-JJ\n  const parts = s.split(\"-\");\n  if (parts.length !== 3) return s;\n  const [y, m, d] = parts;\n  return `${d}-${m}-${y}`;\n}\n\n// Gestion du zoom (√©chelles jour / semaine / mois)\nfunction setScale(level) {\n  if (!window.gantt) return;\n\n  switch (level) {\n    case \"day\":\n      gantt.config.scales = [\n        { unit: \"month\", step: 1, format: \"%F %Y\" },\n        { unit: \"day\", step: 1, format: \"%d-%m\" },\n      ];\n      break;\n\n    case \"month\":\n      gantt.config.scales = [\n        { unit: \"year\", step: 1, format: \"%Y\" },\n        { unit: \"month\", step: 1, format: \"%M\" },\n      ];\n      break;\n\n    case \"week\":\n    default:\n      gantt.config.scales = [\n        { unit: \"year\", step: 1, format: \"%Y\" },\n        {\n          unit: \"week\",\n          step: 1,\n          format: function (date) {\n            const weekStr = gantt.date.date_to_str(\"%W\")(date);\n            return \"S\" + weekStr;\n          },\n        },\n        { unit: \"day\", step: 1, format: \"%d\" },\n      ];\n      break;\n  }\n\n  gantt.render();\n}\n\n// -------- Mapping des donn√©es Appsmith -> Gantt --------\n\n// Transforme QryDashboardSuiviFabrication.data -> { data: tasks, links }\nfunction mapRowsToGantt(rows) {\n  const tasks = [];\n  const links = [];\n\n  rows.forEach((r) => {\n    const appareilId = String(r.numero_appareil);\n    const appareilLabel = `${r.numero_appareil} - ${r.nom_appareil}`;\n    const etapes = Array.isArray(r.etapes) ? r.etapes : [];\n\n    // d√©lai de l'appareil (pour la barre projet et pour la colonne Start time)\n    const delaiStr = r.delai ? String(r.delai).slice(0, 10) : null;\n\n    // --- date de la premi√®re √©tape (min des dates) ---\n    let firstStepDate = null;\n\n    etapes.forEach((e, idx) => {\n      const rawStart = e.date_objectif || e.date_fin;\n      const rawEnd = e.date_fin || e.date_objectif;\n      if (!rawStart && !rawEnd) return;\n\n      const startStr = String(rawStart || rawEnd).slice(0, 10); // YYYY-MM-DD\n\n      if (!firstStepDate || startStr < firstStepDate) {\n        firstStepDate = startStr;\n      }\n    });\n\n    const today = new Date().toISOString().slice(0, 10);\n\n    // --- dates de la barre \"projet\" (bleue) ---\n    // d√©but = premi√®re √©tape, sinon d√©lai, sinon aujourd'hui\n    const projectStart = firstStepDate || delaiStr || today;\n    // fin = d√©lai, sinon premi√®re √©tape, sinon d√©but\n    const projectEnd = delaiStr || firstStepDate || projectStart;\n\n    // --- t√¢che \"projet\" pour l'appareil ---\n    tasks.push({\n      id: appareilId,\n      text: appareilLabel,\n      nom_appareil: r.nom_appareil,   // utilis√© dans la colonne Task name\n      start_date: projectStart,       // üëà d√©but = premi√®re √©tape\n      end_date: projectEnd,           // üëà fin = d√©lai\n      delai: delaiStr,                // pour la colonne Start time de la grille\n      type: \"project\",\n      open: true,\n    });\n\n    // --- t√¢ches enfants pour chaque grande √©tape ---\n    let prevChildId = null;\n\n    etapes.forEach((e, idx) => {\n      const code = e.groupe_code || `ETAPE_${idx}`;\n      const libelle = e.groupe_libelle || code;\n\n      const rawStart = e.date_objectif || e.date_fin;\n      const rawEnd = e.date_fin || e.date_objectif;\n      if (!rawStart && !rawEnd) return;\n\n      const startStr = String(rawStart || rawEnd).slice(0, 10);\n      let endStr = String(rawEnd || rawStart).slice(0, 10);\n\n      // Gantt n'aime pas les t√¢ches de dur√©e 0 -> on force +1 jour si start=end\n      if (endStr === startStr) {\n        const d = new Date(startStr + \"T00:00:00Z\");\n        d.setUTCDate(d.getUTCDate() + 1);\n        endStr = d.toISOString().slice(0, 10);\n      }\n\n      const childId = `${appareilId}_${code}_${idx}`;\n\n      tasks.push({\n        id: childId,\n        text: libelle,\n        start_date: startStr,\n        end_date: endStr,\n        parent: appareilId,\n        progress: 0,\n        status: e.statut_code, // pour la couleur via CSS\n        date_objectif: e.date_objectif\n          ? String(e.date_objectif).slice(0, 10)\n          : null,             // utilis√© dans ta colonne Start time pour les √©tapes\n      });\n\n      // lien de d√©pendance (fin -> d√©but) avec l'√©tape pr√©c√©dente de l'appareil\n      if (prevChildId) {\n        links.push({\n          id: `${prevChildId}->${childId}`,\n          source: prevChildId,\n          target: childId,\n          type: 0, // 0 = finish_to_start\n        });\n      }\n      prevChildId = childId;\n    });\n  });\n\n  return { data: tasks, links };\n}\n\n\n\n// -------- Initialisation + rendu Gantt --------\n\nasync function renderGantt() {\n  const rows = (appsmith.model && appsmith.model.rows) || [];\n  if (!Array.isArray(rows) || !rows.length) return;\n\n  await ensureGanttLoaded();\n\n  // üîπ on mappe D'ABORD les donn√©es -> tasks + links\n  const ganttData = mapRowsToGantt(rows);\n\n  // üîπ on calcule la largeur id√©ale de la colonne \"Task name\"\n  const idealWidth = computeTaskColumnWidth(ganttData.data);\n\n  // Init une seule fois\n  if (!window.ganttInitialized) {\n    // lecture seule\n    gantt.config.readonly = true;\n    gantt.config.date_format = \"%Y-%m-%d\";\n\n    // (dans la version gratuite, grid_resize ne donne pas de drag, mais on peut le laisser)\n    gantt.config.grid_resize = true;\n\n    // Colonnes du tableau √† gauche\n    gantt.config.columns = [\n      {\n        name: \"text\",\n        label: \"Task name\",\n        tree: true,\n        width: idealWidth,   // üëà largeur auto en fonction du texte\n        min_width: 120,\n        template: function (task) {\n          // Pour les appareils : uniquement le nom_appareil\n          if (task.type === \"project\") {\n            return task.nom_appareil || task.text;\n          }\n          // Pour les √©tapes : libell√© normal\n          return task.text;\n        },\n      },\n      {\n        // Colonne start personnalis√©e :\n        // appareil  -> d√©lai de l'appareil\n        // √©tape     -> date objectif\n        name: \"start_custom\",\n        label: \"Start time\",\n        align: \"center\",\n        width: 100,\n        template: function (task) {\n          if (task.type === \"project\") {\n            const d = task.delai || task.start_date;\n            return formatDateFr(d);\n          }\n          const d = task.date_objectif || task.start_date;\n          return formatDateFr(d);\n        },\n      },\n      {\n        // Colonne fin en DD-MM-YYYY\n        name: \"end_custom\",\n        label: \"End time\",\n        align: \"center\",\n        width: 100,\n        template: function (task) {\n          return formatDateFr(task.end_date);\n        },\n      },\n    ];\n\n    // Week-end en gris\n    gantt.templates.scale_cell_class = function (date) {\n      const day = date.getDay();\n      return day === 0 || day === 6 ? \"weekend\" : \"\";\n    };\n    gantt.templates.timeline_cell_class = function (task, date) {\n      const day = date.getDay();\n      return day === 0 || day === 6 ? \"weekend\" : \"\";\n    };\n\n    // Classe CSS selon le statut\n    gantt.templates.task_class = function (start, end, task) {\n      if (task.status) {\n        return \"status-\" + task.status;\n      }\n      return \"\";\n    };\n\n    // Init gantt\n    gantt.init(\"gantt_here\");\n    window.ganttInitialized = true;\n\n    // Zoom par d√©faut : vue semaine\n    setScale(\"week\");\n\n    // Gestion des boutons de zoom dans la toolbar HTML\n    const toolbar = document.querySelector(\".planning-toolbar\");\n    if (toolbar) {\n      toolbar.addEventListener(\"click\", function (e) {\n        const btn = e.target.closest(\"button[data-zoom]\");\n        if (!btn) return;\n        const level = btn.getAttribute(\"data-zoom\");\n        setScale(level);\n      });\n    }\n  }\n\n  // üîπ on applique ensuite les donn√©es\n  gantt.clearAll();\n  gantt.parse(ganttData);\n}\n\n// Initialisation et rafra√Æchissements\nappsmith.onReady(renderGantt);\nappsmith.onModelChange(renderGantt);\n\n\n// Initialisation et rafra√Æchissements\nappsmith.onReady(renderGantt);\nappsmith.onModelChange(renderGantt);\n"
  },
  "version": 1,
  "widgetId": "zrz31k4sda",
  "widgetName": "CustomPlanningCopy"
}