SELECT
  wga.id          AS groupe_appareil_id,
  wci.code        AS controle_code,   -- 'VISUELS','DIMENSIONNELS',...
  wci.na,
  wci.fait,
  wci.date
FROM public.workflow_groupe_appareil wga
JOIN public.workflow_groupe_etape     wge ON wge.id = wga.groupe_id
LEFT JOIN public.workflow_controle_item wci ON wci.groupe_appareil_id = wga.id
WHERE wga.numero_appareil = '{{ appsmith.URL.queryParams.numero_appareil }}'
  AND wge.code = 'CONTROLE';
