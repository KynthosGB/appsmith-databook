{
  "gitSyncId": "6915b9d6a2ab6852a3eeef70_87e370ff-5ba8-4d6d-a699-b39730f13969",
  "id": "Administration_QrySaveAlertRule",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "UPDATE public.alert_rules\nSET\n  event_type = '{{ TableAlertRules.updatedRow.event_type ?? TableAlertRules.triggeredRow.event_type }}',\n\n  step_code = CASE\n    WHEN '{{ TableAlertRules.updatedRow.event_type ?? TableAlertRules.triggeredRow.event_type }}' = 'STATUS_CHANGED'\n      THEN NULLIF('{{ TableAlertRules.updatedRow.step_code ?? TableAlertRules.triggeredRow.step_code }}','')\n    ELSE NULL\n  END,\n\n  status_code = CASE\n    WHEN '{{ TableAlertRules.updatedRow.event_type ?? TableAlertRules.triggeredRow.event_type }}' = 'STATUS_CHANGED'\n      THEN NULLIF('{{ TableAlertRules.updatedRow.status_code ?? TableAlertRules.triggeredRow.status_code }}','')\n    ELSE NULL\n  END,\n\n  event_key = CASE\n    WHEN '{{ TableAlertRules.updatedRow.event_type ?? TableAlertRules.triggeredRow.event_type }}' <> 'STATUS_CHANGED'\n      THEN NULLIF('{{ TableAlertRules.updatedRow.event_key ?? TableAlertRules.triggeredRow.event_key }}','')\n    ELSE NULL\n  END,\n\n  -- comme tu as décidé: toujours true (et caché)\n  event_value = CASE\n    WHEN '{{ TableAlertRules.updatedRow.event_type ?? TableAlertRules.triggeredRow.event_type }}' <> 'STATUS_CHANGED'\n      THEN 'true'\n    ELSE NULL\n  END,\n\n  target_type = '{{ TableAlertRules.updatedRow.target_type ?? TableAlertRules.triggeredRow.target_type ?? \"DM\" }}',\n\n  target_everwin_user_id = CASE\n    WHEN '{{ TableAlertRules.updatedRow.target_type ?? TableAlertRules.triggeredRow.target_type ?? \"DM\" }}' = 'DM'\n      THEN NULLIF('{{ TableAlertRules.updatedRow.target_everwin_user_id ?? TableAlertRules.triggeredRow.target_everwin_user_id }}','')\n    ELSE NULL\n  END,\n\n  target_slack_channel_id = CASE\n    WHEN '{{ TableAlertRules.updatedRow.target_type ?? TableAlertRules.triggeredRow.target_type ?? \"DM\" }}' = 'CHANNEL'\n      THEN NULLIF('{{ TableAlertRules.updatedRow.target_slack_channel_id ?? TableAlertRules.triggeredRow.target_slack_channel_id }}','')\n    ELSE NULL\n  END,\n\n  enabled = {{\n\t\t(() => {\n\t\t\tconst v = TableAlertRules.updatedRow.enabled ?? TableAlertRules.triggeredRow.enabled;\n\t\t\tif (v === true || v === false) return v;\n\t\t\tif (v === \"true\") return true;\n\t\t\tif (v === \"false\") return false;\n\t\t\treturn true; // défaut\n\t\t})()\n\t}},\n\n\tonly_on_change = {{\n\t\t(() => {\n\t\t\tconst v = TableAlertRules.updatedRow.only_on_change ?? TableAlertRules.triggeredRow.only_on_change;\n\t\t\tif (v === true || v === false) return v;\n\t\t\tif (v === \"true\") return true;\n\t\t\tif (v === \"false\") return false;\n\t\t\treturn true; // défaut\n\t\t})()\n\t}},\n\n  throttle_minutes = {{\n\t\t(() => {\n\t\t\tconst v = TableAlertRules.updatedRow.throttle_minutes ?? TableAlertRules.triggeredRow.throttle_minutes;\n\t\t\tconst n = Number(v);\n\t\t\treturn Number.isFinite(n) ? n : 0;\n\t\t})()\n\t}},\n\n\n  description = '{{ ((TableAlertRules.updatedRow.description ?? TableAlertRules.triggeredRow.description) || \"\").replaceAll(\"'\", \"''\") }}',\n  updated_at = now()\n\nWHERE id = {{\n  TableAlertRules.updatedRow?.id\n  ?? TableAlertRules.triggeredRow?.id\n}};\n\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "Databook - Neon",
      "isAutoGenerated": false,
      "name": "Databook - Neon",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "QrySaveAlertRule",
    "pageId": "Administration",
    "runBehaviour": "MANUAL",
    "userSetOnLoad": false
  }
}